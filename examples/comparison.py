import sys
import argparse

from pymchelper.detector import Detector


def main(args=sys.argv[1:]):
    """
    Reading two files, one generated by Fluka and one generated by SHIELD-HIT12A
    :param args:
    :return:
    """

    # parsing command line options
    parser = argparse.ArgumentParser(args)
    parser.add_argument("--fluka", help='binary file generated with Fluka', type=str, required=True)
    parser.add_argument("--shield", help='binary file generated with SHIELD-HIT12A', type=str, required=True)
    parsed_args = parser.parse_args(args)

    # paths to binary files
    fluka_file_path = parsed_args.fluka
    sh12a_file_path = parsed_args.shield

    # creating empty Detector object and filling it with data read from Fluka file
    fluka_data = Detector()
    fluka_data.read(fluka_file_path)

    # same as above but reading from SHIELD-HIT12A file
    sh12a_data = Detector()
    sh12a_data.read(sh12a_file_path)

    # printing some output on the screen
    print("Fluka bins in X: {:d}, Y: {:d}, Z: {:d}".format(fluka_data.nx, fluka_data.ny, fluka_data.nz))
    print("First bin of fluka data", fluka_data.v[0])

    print("SHIELD-HIT12A bins in X: {:d}, Y: {:d}, Z: {:d}".format(sh12a_data.nx, sh12a_data.ny, sh12a_data.nz))
    print("First bin of SHIELD-HIT12A data", sh12a_data.v[0])

    # comparing file contents
    print("Difference Fluka - SHIELD-HIT12A", (sh12a_data.v - fluka_data.v)[0:5], "...")


if __name__ == '__main__':
    sys.exit(main(sys.argv[1:]))
